---
layout: post
title: Variational Inference Algorithm
---

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>Variational Inference algorithm &#8211; An La (Yên Vũ)</title>
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Fondamento:r:latin,latin-ext","Karla:r,i,b,bi:latin,latin-ext"]}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active html{font-family:"Karla",sans-serif}.wf-active pre{font-family:"Karla",sans-serif}.wf-active body, .wf-active button, .wf-active input, .wf-active select, .wf-active textarea{font-family:"Karla",sans-serif}.wf-active pre{font-family:"Karla",sans-serif}.wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6, .wf-active .site-title{font-family:"Fondamento",cursive;font-weight:400;font-style:normal}.wf-active h1{font-size:37.7px;font-style:normal;font-weight:400}.wf-active h2{font-size:29.9px;font-style:normal;font-weight:400}.wf-active h3{font-size:23.4px;font-style:normal;font-weight:400}.wf-active h4{font-size:18.2px;font-style:normal;font-weight:400}.wf-active h5{font-size:16.9px;font-style:normal;font-weight:400}.wf-active h6{font-size:15.6px;font-style:normal;font-weight:400}.wf-active .singular .site-title{font-size:37.7px;font-style:normal;font-weight:400}.wf-active .entry-title{font-size:37.7px;font-style:normal;font-weight:400}.wf-active .page-title{font-size:37.7px;font-style:normal;font-weight:400}.wf-active .widget-title, .wf-active .widgettitle{font-size:23.4px;font-style:normal;font-weight:400}.wf-active .widget_calendar th{font-weight:400;font-style:normal}@media screen and ( min-width: 45em ){.wf-active .singular .entry-title, .wf-active h1{font-size:61.1px;font-style:normal;font-weight:400}}@media screen and ( min-width: 45em ){.wf-active h2{font-size:37.7px;font-style:normal;font-weight:400}}@media screen and ( min-width: 45em ){.wf-active h3{font-size:29.9px;font-style:normal;font-weight:400}}@media screen and ( min-width: 45em ){.wf-active h4{font-size:23.4px;font-style:normal;font-weight:400}}@media screen and ( min-width: 45em ){.wf-active h5{font-size:18.2px;font-style:normal;font-weight:400}}@media screen and ( min-width: 45em ){.wf-active h6{font-size:16.9px;font-style:normal;font-weight:400}}@media screen and ( min-width: 45em ){.wf-active .sticking .site-title{font-size:23.4px;font-style:normal;font-weight:400}}</style>
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//wordpress.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="An La (Yên Vũ) &raquo; Feed" href="https://langocthuyan.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="An La (Yên Vũ) &raquo; Comments Feed" href="https://langocthuyan.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="An La (Yên Vũ) &raquo; Variational Inference algorithm Comments Feed" href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1596548281h&ver=5.5-wpcom-48931"}};
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJydkt1uwjAMhV9oaUanIXEx7Vny4xVD/hQ7sL79TGEVKqwXu4lynPP5KE70uSiXE0NiHZsqoQ2YSJ+Ly1FRxADjQnWO6EU/x6hZchULYxb1lUPI5zX/Pp+gKtusDSA0jwFmOyYXmpeyFLQ3tEdpQF3E9Gg5kGY5P9r8PW/WcisEw+BVycQLtYYFPF7CgItxRzWpB/uvd2giLdRBTiroXdd3vbYNg9c25Am31dRxceu/20zUXboZc2M1VPT/bVENYxqWc1/iLt+wfrqCR+K5pp6jdyMzXh5MWVNvn2jWVwh1yjw97LxZ63YZpdRjMXxxRPBoIEAU2xp2jba2VCBSskZsUfFewCnuM35stq9vm12/3b4ffgDAHigM?cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id='wpcom-admin-bar-inline-css'>

			.admin-bar {
				position: inherit !important;
				top: auto !important;
			}
			.admin-bar .goog-te-banner-frame {
				top: 32px !important
			}
			@media screen and (max-width: 782px) {
				.admin-bar .goog-te-banner-frame {
					top: 46px !important;
				}
			}
			@media screen and (max-width: 480px) {
				.admin-bar .goog-te-banner-frame {
					position: absolute;
				}
			}
		
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--color--black:#000000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#ffffff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small:13;--wp--preset--font-size--normal:16;--wp--preset--font-size--medium:20;--wp--preset--font-size--large:36;--wp--preset--font-size--huge:42;}.has-black-color{color:#000000;}
.has-cyan-bluish-gray-color{color:#abb8c3;}
.has-white-color{color:#ffffff;}
.has-pale-pink-color{color:#f78da7;}
.has-vivid-red-color{color:#cf2e2e;}
.has-luminous-vivid-orange-color{color:#ff6900;}
.has-luminous-vivid-amber-color{color:#fcb900;}
.has-light-green-cyan-color{color:#7bdcb5;}
.has-vivid-green-cyan-color{color:#00d084;}
.has-pale-cyan-blue-color{color:#8ed1fc;}
.has-vivid-cyan-blue-color{color:#0693e3;}
.has-vivid-purple-color{color:#9b51e0;}
.has-black-background-color{background-color:#000000;}
.has-cyan-bluish-gray-background-color{background-color:#abb8c3;}
.has-white-background-color{background-color:#ffffff;}
.has-pale-pink-background-color{background-color:#f78da7;}
.has-vivid-red-background-color{background-color:#cf2e2e;}
.has-luminous-vivid-orange-background-color{background-color:#ff6900;}
.has-luminous-vivid-amber-background-color{background-color:#fcb900;}
.has-light-green-cyan-background-color{background-color:#7bdcb5;}
.has-vivid-green-cyan-background-color{background-color:#00d084;}
.has-pale-cyan-blue-background-color{background-color:#8ed1fc;}
.has-vivid-cyan-blue-background-color{background-color:#0693e3;}
.has-vivid-purple-background-color{background-color:#9b51e0;}
.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);}
.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);}
.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);}
.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);}
.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);}
.has-cool-to-warm-spectrum-gradient-background{background:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);}
.has-blush-light-purple-gradient-background{background:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);}
.has-blush-bordeaux-gradient-background{background:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);}
.has-luminous-dusk-gradient-background{background:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);}
.has-pale-ocean-gradient-background{background:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);}
.has-electric-grass-gradient-background{background:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);}
.has-midnight-gradient-background{background:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);}
.has-small-font-size{font-size:13;}
.has-normal-font-size{font-size:16;}
.has-medium-font-size{font-size:20;}
.has-large-font-size{font-size:36;}
.has-huge-font-size{font-size:42;}

</style>
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPLdUtyClNz8wr1k/Oz80FCunmZGanAnnFaCJ6QBEdfSStJRmpuUCFBaVJ+jmZSUWpukb6xSWVOanEKASZnpSTn5wNNtY+19bQ1NLQwtjczMQwCwCcPTlx?cssminify=yes' type='text/css' media='all' />
<style id='libre-2-style-inline-css'>
.byline { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link crossorigin="anonymous" rel='stylesheet' id='libre-2-fonts-css'  href='https://fonts.googleapis.com/css?family=Libre+Baskerville%3A400%2C400italic%2C700&#038;subset=latin%2Clatin-ext' media='all' />
<link rel='stylesheet' id='all-css-4-1' href='https://s0.wp.com/_static/??-eJyNkEsOwjAMRC+ESYGCxAJxFrcxUcCJo8Sl4vakK35SxG5GnjeWbeYEo0SlqCZMkHhyPhYze+tIi1FJkKRUVfTBtB5LWZk2QlOdys0TMM5GKSRGpT8KHAmwjKhe4oeBC6PPLTTKsgFt8BEGzHDfttKZBhZXpTM19WZbkEqBTEmywkVy+PY/6NL5+o1ki7aeyDIgL9lzOG0OXdfvj7uuvz4BAMiR/Q==?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-5-1' href='https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-6-1' href='https://s0.wp.com/wp-content/mu-plugins/admin-bar/masterbar-overrides/masterbar.css?m=1601397431h&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='all-css-8-1' href='https://s0.wp.com/_static/??-eJx1zc0KwjAQBOAXcl38qa0H8VmSEJOVTTZkE0rf3vbgQdTTMDAfg3MBJ7n53DB1KNwDZcUi2uDBhipqNJVyeOfeqe7wt1JxZBhYgnyWL9SiT3696RaZbPVwRMoOtS3sYS5O0j8SzxhYrOFtcE+3w3Adx8swnabnC8ghSqY=?cssminify=yes' type='text/css' media='all' />
<script id='jetpack_related-posts-js-extra'>
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script id='wpcom-actionbar-placeholder-js-extra'>
var actionbardata = {"siteID":"60408846","siteName":"An La (Y\u00ean V\u0169)","siteURL":"http:\/\/langocthuyan.wordpress.com","icon":"<img alt='' src='https:\/\/langocthuyan.files.wordpress.com\/2020\/03\/cropped-hn.jpg?w=50' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"1","canCustomizeSite":"1","isFollowing":"1","themeSlug":"pub\/libre-2","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Flangocthuyan.wordpress.com%2F2020%2F03%2F24%2Fvariational-inference-algorithm%2F&signup_flow=account","themeURL":"https:\/\/wordpress.com\/theme\/libre-2\/","xhrURL":"https:\/\/langocthuyan.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"ac976bb5ba","isSingular":"1","isFolded":"","isLoggedIn":"1","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"c79ef866ba\" \/>","referer":"https:\/\/langocthuyan.wordpress.com\/2020\/03\/24\/variational-inference-algorithm\/","canFollow":"1","feedID":"15639022","statusMessage":"","customizeLink":"https:\/\/langocthuyan.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Flangocthuyan.wordpress.com%2F2020%2F03%2F24%2Fvariational-inference-algorithm%2F","postID":"1024","shortlink":"https:\/\/wp.me\/p45t6e-gw","canEditPost":"1","editLink":"https:\/\/wordpress.com\/post\/langocthuyan.wordpress.com\/1024","statsLink":"https:\/\/wordpress.com\/stats\/post\/1024\/langocthuyan.wordpress.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get help setting up your theme","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Flangocthuyan.wordpress.com%2F2020%2F03%2F24%2Fvariational-inference-algorithm%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats"}};
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJx9j9EKwjAMRX/IWiY63IP4LVuXjZSsqU3D8O/NwwQdIgTCvZzcJH7NDlMgHUF8tHoolOfWjlEO3oDAqUKqflGXSWdM4kUHCQVzRTY1MRGve9ziFh6QwKlA6WfzbNfEf2ILUF9hdJml7tR76vNayZh++d9fbNR9uTWXrmlP7bU7xxc6zVy6'></script>
<link rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1530132353h&cssminify=yes' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s0.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://langocthuyan.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s0.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Getting started with Bayesian&nbsp;Inference' href='https://langocthuyan.wordpress.com/2020/03/23/getting-started-with-bayesian-inference/' />
<link rel='next' title='Neural Algorithm of Artistic Style Transfer: Understanding with PyTorch&nbsp;examples' href='https://langocthuyan.wordpress.com/2020/04/20/neural-algorithm-of-artistic-style-transfer-understanding-and-examples-with-pytorch/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/" />
<link rel='shortlink' href='https://wp.me/p45t6e-gw' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Flangocthuyan.wordpress.com%2F2020%2F03%2F24%2Fvariational-inference-algorithm%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Flangocthuyan.wordpress.com%2F2020%2F03%2F24%2Fvariational-inference-algorithm%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Variational Inference algorithm" />
<meta property="og:url" content="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/" />
<meta property="og:description" content="Sampling data or approximating probabilistic densities is one of the core problems in modern statistics, especially in Bayesian statistic. Beside of MCMC, Variational Inference is one of the two ty…" />
<meta property="article:published_time" content="2020-03-24T09:11:16+00:00" />
<meta property="article:modified_time" content="2020-04-28T19:18:41+00:00" />
<meta property="og:site_name" content="An La (Yên Vũ)" />
<meta property="og:image" content="https://langocthuyan.files.wordpress.com/2020/03/cropped-hn.jpg?w=200" />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:text:title" content="Variational Inference algorithm" />
<meta name="twitter:image" content="https://langocthuyan.files.wordpress.com/2020/03/cropped-hn.jpg?w=240" />
<meta name="twitter:card" content="summary" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />

<!-- End Jetpack Open Graph Tags -->
<link rel='openid.server' href='https://langocthuyan.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://langocthuyan.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://langocthuyan.wordpress.com/osd.xml" title="An La (Yên Vũ)" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="theme-color" content="#fdfdfd" />
<link rel="pingback" href="https://langocthuyan.wordpress.com/xmlrpc.php"><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="An La (Yên Vũ)" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Author posts, manage comments, and manage An La (Yên Vũ)." /><meta name="msapplication-task" content="name=Edit post;action-uri=https://wordpress.com/post/langocthuyan.wordpress.com/1024;icon-uri=https://s0.wp.com/i/icons/post.ico" /><meta name="msapplication-task" content="name=Write a post;action-uri=https://wordpress.com/post/langocthuyan.wordpress.com;icon-uri=https://s0.wp.com/i/icons/post.ico" /><meta name="msapplication-task" content="name=Moderate comments;action-uri=https://langocthuyan.wordpress.com/wp-admin/edit-comments.php?comment_status=moderated;icon-uri=https://s0.wp.com/i/icons/comment.ico" /><meta name="msapplication-task" content="name=Upload new media;action-uri=https://langocthuyan.wordpress.com/wp-admin/media-new.php;icon-uri=https://s0.wp.com/i/icons/media.ico" /><meta name="msapplication-task" content="name=Blog stats;action-uri=https://langocthuyan.wordpress.com/wp-admin/index.php?page=stats;icon-uri=https://s0.wp.com/i/icons/stats.ico" /><meta name="description" content="Sampling data or approximating probabilistic densities is one of the core problems in modern statistics, especially in Bayesian statistic. Beside of MCMC, Variational Inference is one of the two typical Bayesian approaches solving this problem. It leverages the Variational Inference algorithm to develop many recent powerful methods and models: Stochastic Variational Inference, Variational Autoencoder... This&hellip;" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fdfdfd; }
</style>
	<link rel="amphtml" href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/amp/"><style type="text/css" media="print">#wpadminbar { display:none; }</style>
	<style type="text/css" media="screen">
	html { margin-top: 32px !important; }
	* html body { margin-top: 32px !important; }
	@media screen and ( max-width: 782px ) {
		html { margin-top: 46px !important; }
		* html body { margin-top: 46px !important; }
	}
</style>
	<style type="text/css" id="custom-colors-css">body,.sticking .site-header,.main-navigation ul ul,.widget_archive a,.widget_categories a,.widget .post-count{background-color:#fdfdfd}.custom-background .site{background-color:#fdfdfd}input[type=text],input[type=email],input[type=url],input[type=password],input[type=search]{background-color:#fdfdfd}</style>
<link rel="icon" href="https://langocthuyan.files.wordpress.com/2020/03/cropped-hn.jpg?w=32" sizes="32x32" />
<link rel="icon" href="https://langocthuyan.files.wordpress.com/2020/03/cropped-hn.jpg?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://langocthuyan.files.wordpress.com/2020/03/cropped-hn.jpg?w=180" />
<meta name="msapplication-TileImage" content="https://langocthuyan.files.wordpress.com/2020/03/cropped-hn.jpg?w=270" />
</head>

<body class="post-template-default single single-post postid-1024 single-format-standard logged-in admin-bar no-customize-support custom-background wp-embed-responsive customizer-styles-applied singular author-hidden highlander-enabled highlander-light">
<div class="site-wrapper">
	<div id="page" class="hfeed site">
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
				<a href="https://langocthuyan.wordpress.com/" rel="home">
			<img src="https://langocthuyan.files.wordpress.com/2020/03/cropped-landscape-1584103138399-5440-2-8.jpg" width="1088" height="479" alt="" class="custom-header">
		</a>
				<header id="masthead" class="site-header" role="banner">
			<div class="site-branding">
																						<p class="site-title"><a href="https://langocthuyan.wordpress.com/" rel="home">An La (Yên Vũ)</a></p>
							</div><!-- .site-branding -->

			<div class="nav-wrapper">
				<nav id="site-navigation" class="main-navigation" role="navigation">
					<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">&#9776; Menu</button>
					<div class="menu-structure-container"><ul id="primary-menu" class="menu"><li id="menu-item-139" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-139"><a title="About me" href="https://langocthuyan.wordpress.com/about/">About me</a></li>
<li id="menu-item-851" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-851"><a href="https://langocthuyan.wordpress.com/highlight-posts/">Highlights</a></li>
<li id="menu-item-140" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-140"><a title="Recent Articles" href="https://langocthuyan.wordpress.com/">Recent Articles</a></li>
<li id="menu-item-637" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-637"><a href="https://langocthuyan.wordpress.com/category/collections/data-science/">Data Science</a>
<ul class="sub-menu">
	<li id="menu-item-970" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-970"><a href="https://langocthuyan.wordpress.com/category/collections/data-science/practice/">Practice</a></li>
	<li id="menu-item-969" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-969"><a href="https://langocthuyan.wordpress.com/category/collections/data-science/learning/">Learning</a></li>
</ul>
</li>
<li id="menu-item-388" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-388"><a href="https://langocthuyan.wordpress.com/category/other/competitive-programming/">Competitive Programming</a></li>
</ul></div>									</nav><!-- #site-navigation -->

							</div>

		</header><!-- #masthead -->

		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-1024" class="post-1024 post type-post status-publish format-standard hentry category-data-science category-learning category-statistical-approach tag-svi tag-approximating tag-bayesian tag-inference tag-kl-divergence tag-mean-field tag-natural-gradient tag-posterior tag-prior tag-variational tag-variational-inference">
		<header class="entry-header">
		<h1 class="entry-title">Variational Inference algorithm</h1>
		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/" rel="bookmark"><time class="entry-date published" datetime="2020-03-24T16:11:16+07:00">March 24, 2020</time><time class="updated" datetime="2020-04-29T02:18:41+07:00">April 29, 2020</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://langocthuyan.wordpress.com/author/anvy1102/">An La</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<p style="font-size:18px;">Sampling data or approximating probabilistic densities is one of the core problems in modern statistics, especially in Bayesian statistic. Beside of MCMC, Variational Inference is one of the two typical Bayesian approaches solving this problem. It leverages the Variational Inference algorithm to develop many recent powerful methods and models: Stochastic Variational Inference, Variational Autoencoder&#8230; This article briefly introduces Variational Inference algorithm.</p>



<p style="font-size:18px;">The main ideas of Variational Inference (VI) is approximating the posterior with simpler variational distribution by solving optimization problem. The section 1 reviews Bayesian inference and latent variables. Section 2 presents objective of the algorithm and why it solves optimization problem. Section 3 shows some important mathematical contributions while attempting the target. Section 4 introduces Stochastic Variational Inference and finally  the summary is presented.</p>



<h2>1. Bayesian Inference and Latent variables</h2>



<ul><li><strong><em>Bayesian Inference</em></strong></li></ul>



<p style="font-size:18px;">Bayesian inference supposes the probability of observations <img src="https://s0.wp.com/latex.php?latex=x&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="x" title="x" class="latex" /> or tractable distributions depend on a quantity, called prior. Prior reflects personal perspective about observations, comes from knowledge of experts or tuning through experiments. Let denote it as <img src="https://s0.wp.com/latex.php?latex=%5Ctheta&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;theta" title="&#92;theta" class="latex" />. </p>



<p style="font-size:18px;" class="has-text-align-center">Prior: <img src="https://s0.wp.com/latex.php?latex=p%28%5Ctheta%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(&#92;theta)" title="p(&#92;theta)" class="latex" /></p>



<p style="font-size:18px;">Given <img src="https://s0.wp.com/latex.php?latex=theta&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="theta" title="theta" class="latex" />, we can figure out what probability of outcome by a evidence function: </p>



<p style="font-size:18px;" class="has-text-align-center">Likelihood: <img src="https://s0.wp.com/latex.php?latex=p%28x%7C%5Ctheta%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(x|&#92;theta)" title="p(x|&#92;theta)" class="latex" /></p>



<p style="font-size:18px;">We don&#8217;t always know exact values of prior. Therefore, we have the hypothesis reflecting how much <img src="https://s0.wp.com/latex.php?latex=%5Ctheta&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;theta" title="&#92;theta" class="latex" /> is matched with <em>the true prior</em>. With Bayes theorem: <img src="https://s0.wp.com/latex.php?latex=p%28A%7CB%29%3D%5Cdfrac%7Bp%28B%7CA%29p%28A%29%7D%7Bp%28B%29%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(A|B)=&#92;dfrac{p(B|A)p(A)}{p(B)}" title="p(A|B)=&#92;dfrac{p(B|A)p(A)}{p(B)}" class="latex" />, the posterior is:</p>



<p style="font-size:18px;" class="has-text-align-center">Posterior: <img src="https://s0.wp.com/latex.php?latex=p%28%5Ctheta%7Cx%29+%3D+%5Cdfrac%7Bp%28x%7C%5Ctheta%29p%28%5Ctheta%29%7D%7Bp%28x%29%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(&#92;theta|x) = &#92;dfrac{p(x|&#92;theta)p(&#92;theta)}{p(x)}" title="p(&#92;theta|x) = &#92;dfrac{p(x|&#92;theta)p(&#92;theta)}{p(x)}" class="latex" /></p>



<p style="font-size:18px;">To test which parameters is best in describing the data, methods find which one has the maximum value of the likelihood or the posterior. If you&#8217;re not familiar with Bayesian inference, please read this <a href="https://langocthuyan.wordpress.com/2020/03/23/getting-started-with-bayesian-inference/"><strong><em>post</em></strong></a>.</p>



<ul><li><strong><em>Latent variables</em></strong></li></ul>



<blockquote class="wp-block-quote" style="font-size:14px;"><p>In statistics, latent variables are variables that are not directly observed but are rather inferred (through a mathematical model) from other variables that are observed (directly measured). Mathematical models that aim to explain observed variables in terms of latent variables are called latent variable models.</p><cite>See <a href="https://en.wikipedia.org/wiki/Latent_variable">Wikipedia</a></cite></blockquote>



<p style="font-size:18px;">Latent variables are not directly observed but we have information about their structure and relationship to the observations. Thus, it can be inferred. In Bayesian inference, they are often factors that allow us to factorize the observations to tractable distributions. </p>



<p style="font-size:18px;">For example, in topic models, the only observation variable is collections of documents with their words. The list of topics, the distribution between topics and documents or words, both of them are latent variables.</p>



<h2>2. Model&#8217;s objective and optimization problem</h2>



<p style="font-size:18px;">Variational Inference strives to sample observations or difficult-to-compute distribution. It uses hidden variables to encode hidden structure in observed data and estimates the posterior. The posterior is not always tractable, therefore, more generic way is approximating it by simpler distribution governed by variational parameters.</p>



<p style="font-size:18px;" class="has-text-align-center">Goal distribution: the posterior <img src="https://s0.wp.com/latex.php?latex=p%28z%7Cx%29+%3D+%5Cdfrac%7Bp%28x%2C+z%29%7D%7B%5Cint+p%28x%2Cz%29+dz%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(z|x) = &#92;dfrac{p(x, z)}{&#92;int p(x,z) dz}" title="p(z|x) = &#92;dfrac{p(x, z)}{&#92;int p(x,z) dz}" class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center">Approximating distribution: the variational distribution <img src="https://s0.wp.com/latex.php?latex=q%28z%3B%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="q(z;&#92;lambda)" title="q(z;&#92;lambda)" class="latex" />, <br>where <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda" title="&#92;lambda" class="latex" /> is a set of variational parameters.</p>



<p style="font-size:18px;" class="has-text-align-center">Loss function: the negative log likelihood <img src="https://s0.wp.com/latex.php?latex=L%28%5Clambda%29+%3D+-+log+p%28x%7C%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L(&#92;lambda) = - log p(x|&#92;lambda)" title="L(&#92;lambda) = - log p(x|&#92;lambda)" class="latex" /></p>



<p style="font-size:18px;">VI measures the distance between distributions by KL divergence:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=D_%7BKL%7D%5Cbigg%28q%28z%29+%7C%7C+p%28z%29%5Cbigg%29+%3D+-%5Cint+q%28z%29+log+%5Cdfrac%7Bp%28z%29%7D%7Bq%28z%29%7D+dz&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="D_{KL}&#92;bigg(q(z) || p(z)&#92;bigg) = -&#92;int q(z) log &#92;dfrac{p(z)}{q(z)} dz" title="D_{KL}&#92;bigg(q(z) || p(z)&#92;bigg) = -&#92;int q(z) log &#92;dfrac{p(z)}{q(z)} dz" class="latex" /></p>



<p style="font-size:18px;">Lower distance means better approximation, thus VI minimizes the distance and the problem becomes finding parameters which have optimal values on the targeting metric.</p>



<p style="font-size:18px;">Instead of directly minimizing <img src="https://s0.wp.com/latex.php?latex=D_%7BKL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="D_{KL}" title="D_{KL}" class="latex" />, authors maximizes ELBO <img src="https://s0.wp.com/latex.php?latex=L%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L(&#92;lambda)" title="L(&#92;lambda)" class="latex" />. For short, this term has close relation to <img src="https://s0.wp.com/latex.php?latex=D_%7BKL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="D_{KL}" title="D_{KL}" class="latex" /> and log likelihood <img src="https://s0.wp.com/latex.php?latex=p%28x%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(x)" title="p(x)" class="latex" />:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=log+p%28x%29+%3D+L%28%5Clambda%29+%2B+D_%7BKL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="log p(x) = L(&#92;lambda) + D_{KL}" title="log p(x) = L(&#92;lambda) + D_{KL}" class="latex" /></p>



<h2>3. Mathematical notes</h2>



<p style="font-size:18px;">This section explains in detail mathematical points and how VI solves optimization problems.</p>



<h3>3.1 <strong><em>Evidence Lower Bound</em></strong> <strong><em>(ELBO)</em></strong></h3>



<p style="font-size:18px;">This term is called ELBO since it is the lower bound of evidence function of data:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=log+p%28x%29%3D+log+%5Cint+p%28x%2Cz%29+dz+%3D+log+%5Cint+%5Cdfrac%7Bp%28x%2Cz%29q%28z%3B%5Clambda%29%7D%7Bq%28z%3B+%5Clambda%29%7D+dz+%3D+log+E_%7Bq%28z%3B%5Clambda%29%7D%5Cbigg%5B%5Cdfrac%7Bp%28x%2Cz%29%7D%7Bq%28z%3B+%5Clambda%29%7D+%5Cbigg%5D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="log p(x)= log &#92;int p(x,z) dz = log &#92;int &#92;dfrac{p(x,z)q(z;&#92;lambda)}{q(z; &#92;lambda)} dz = log E_{q(z;&#92;lambda)}&#92;bigg[&#92;dfrac{p(x,z)}{q(z; &#92;lambda)} &#92;bigg]" title="log p(x)= log &#92;int p(x,z) dz = log &#92;int &#92;dfrac{p(x,z)q(z;&#92;lambda)}{q(z; &#92;lambda)} dz = log E_{q(z;&#92;lambda)}&#92;bigg[&#92;dfrac{p(x,z)}{q(z; &#92;lambda)} &#92;bigg]" class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=%5Cgeq+E_%7Bq%28z%3B%5Clambda%29%7D%5Cbigg%5Blog+%5Cdfrac%7Bp%28x%2Cz%29%7D%7Bq%28z%3B+%5Clambda%29%7D+%5Cbigg%5D+%3D+ELBO%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;geq E_{q(z;&#92;lambda)}&#92;bigg[log &#92;dfrac{p(x,z)}{q(z; &#92;lambda)} &#92;bigg] = ELBO(&#92;lambda)" title="&#92;geq E_{q(z;&#92;lambda)}&#92;bigg[log &#92;dfrac{p(x,z)}{q(z; &#92;lambda)} &#92;bigg] = ELBO(&#92;lambda)" class="latex" /> (applying Jensen&#8217;inequality)</p>



<p style="font-size:18px;">Proof of <img src="https://s0.wp.com/latex.php?latex=log+p%28x%29+%3D+ELBO+%2B+D_%7BKL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="log p(x) = ELBO + D_{KL}" title="log p(x) = ELBO + D_{KL}" class="latex" /> and applying Jensen&#8217;inequality in ELBO, see Section 3 of this <a href="https://langocthuyan.wordpress.com/2020/03/15/jensens-inequality-and-applications-em-algorithm-and-elbo-in-svi/"><em><strong>post</strong></em></a>.</p>



<h3>3.2 <strong><em>Mean-field variational inference</em></strong></h3>



<p style="font-size:18px;">To express <img src="https://s0.wp.com/latex.php?latex=q%28z%3B%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="q(z;&#92;lambda)" title="q(z;&#92;lambda)" class="latex" /> as a function of <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda" title="&#92;lambda" class="latex" />, there are many ways, as well as the tradeoff between expressive to approximate and simple to track. The mean-field theory assumes that all variables are independent to each other, therefore correlation information between them is lost. In VI, the distribution is factorized into factors and each other is governed by its own parameters:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=q%28z%3B+%5Clambda%29+%3D+%5CPi_%7Bi%3D1%7D%5E%7BN%7Dq%28z_i%3B%5Clambda_i%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="q(z; &#92;lambda) = &#92;Pi_{i=1}^{N}q(z_i;&#92;lambda_i)" title="q(z; &#92;lambda) = &#92;Pi_{i=1}^{N}q(z_i;&#92;lambda_i)" class="latex" /></p>



<p style="font-size:18px;">Due to this assumption, VI updates iteratively by pairs <img src="https://s0.wp.com/latex.php?latex=%28z_i%2C+%5Clambda_i%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="(z_i, &#92;lambda_i)" title="(z_i, &#92;lambda_i)" class="latex" /> to optimize <img src="https://s0.wp.com/latex.php?latex=L%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L(&#92;lambda)" title="L(&#92;lambda)" class="latex" /> by gradient descent or coordinate descent.</p>


<pre class="brush: python; title: ; notranslate" title="">
while (ELBO has not convergenced)
	compute ELBO (q)    
	for j in {1, .. m}:
		q_j(z_j) = q_j*(z_j) # optimal value of q_j(z_j)
</pre>


<p style="font-size:18px;">Coordinate descent finds the steepest values of each variable while keeping others fixed, then updates the steepest to the variable. In contrast, gradient descent optimizes the whole dimensions at the same time, but with a small ratio of magnitude rather than full length of distant from current points to optimal values. Each time updating all factors, despite independently or simultaneously, the lower bound (ELBO) is increased, the training process found the better local optimum.</p>



<p style="font-size:18px;">Both gradient descent or coordinate descent work by finding steepest values of local convex loss function.  How to find them?</p>



<h3>3.3 <strong><em>Natural gradient</em></strong></h3>



<p style="font-size:18px;">The important thing to optimize the loss function <img src="https://s0.wp.com/latex.php?latex=L%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L(&#92;lambda)" title="L(&#92;lambda)" class="latex" /> by VI is finding optimal value on each updating step. If the loss function is in Euclidean space, it is easy to compute the distance by simply taking the first-order gradient. However, the parameters are still in Euclidean space, but the distance metric is not. Comparing between 2 distributions with just subtraction their mean is insufficient. A lot of information, such as shape, variation, skew&#8230; of distributions are not considered.  Therefore, we need another way to compare distance metric in distribution space, then indicate how to update parameters on Euclidean space. This is done by natural gradient. </p>



<ul><li><strong><em>Natural gradient</em></strong> and <strong><em>Fisher Information</em></strong></li></ul>



<p style="font-size:18px;">Natural gradient is proven to be extracted by the equation:</p>



<p style="font-size:18px;" class="has-text-align-center"> <img src="https://s0.wp.com/latex.php?latex=%5Chat%5Cnabla+L%28%5Clambda%29+%3D+F%5E%7B-1%7D%5Cnabla+L%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;hat&#92;nabla L(&#92;lambda) = F^{-1}&#92;nabla L(&#92;lambda)" title="&#92;hat&#92;nabla L(&#92;lambda) = F^{-1}&#92;nabla L(&#92;lambda)" class="latex" /><br>where <img src="https://s0.wp.com/latex.php?latex=F&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="F" title="F" class="latex" /> is the Fisher Information of the loss function <img src="https://s0.wp.com/latex.php?latex=L%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L(&#92;lambda)" title="L(&#92;lambda)" class="latex" />.- </p>



<p style="font-size:18px;">The Fisher Information matrix is computed by getting second-order gradient, Hessian matrix, of the <img src="https://s0.wp.com/latex.php?latex=D_%7BKL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="D_{KL}" title="D_{KL}" class="latex" />. </p>



<p style="font-size:18px;">Let <img src="https://s0.wp.com/latex.php?latex=%7BP_%5Ctheta%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="{P_&#92;theta}" title="{P_&#92;theta}" class="latex" /> denote a parametric family of a distribution on space <img src="https://s0.wp.com/latex.php?latex=X&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="X" title="X" class="latex" />. Density function: <img src="https://s0.wp.com/latex.php?latex=p_%5Ctheta&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p_&#92;theta" title="p_&#92;theta" class="latex" />. Equation of Fisher information:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=F_%5Ctheta+%3A%3D+E_%5Ctheta+%5Cbigg%5B+%5Cnabla_%5Ctheta+log+%28p_%5Ctheta%28x%29%29+%5Cnabla_%5Ctheta+log%28p_%5Ctheta%28x%29%29%5ET+%5Cbigg%5D+%3D+-E_%5Ctheta+%5Cbigg%5B+%5Cnabla_%5Ctheta%5E2+log%28p_%5Ctheta%28x%29%29+%5Cbigg%5D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="F_&#92;theta := E_&#92;theta &#92;bigg[ &#92;nabla_&#92;theta log (p_&#92;theta(x)) &#92;nabla_&#92;theta log(p_&#92;theta(x))^T &#92;bigg] = -E_&#92;theta &#92;bigg[ &#92;nabla_&#92;theta^2 log(p_&#92;theta(x)) &#92;bigg]" title="F_&#92;theta := E_&#92;theta &#92;bigg[ &#92;nabla_&#92;theta log (p_&#92;theta(x)) &#92;nabla_&#92;theta log(p_&#92;theta(x))^T &#92;bigg] = -E_&#92;theta &#92;bigg[ &#92;nabla_&#92;theta^2 log(p_&#92;theta(x)) &#92;bigg]" class="latex" /></p>



<ul><li><strong><em>Proof <img src="https://s0.wp.com/latex.php?latex=F%3D+H_%7BKL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="F= H_{KL}" title="F= H_{KL}" class="latex" /></em></strong></li></ul>



<p style="font-size:18px;" class="has-text-align-center">Suppose that <img src="https://s0.wp.com/latex.php?latex=p%28x%7C%5Clambda%5E%2A%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="p(x|&#92;lambda^*)" title="p(x|&#92;lambda^*)" class="latex" /> is the true posterior, and <img src="https://s0.wp.com/latex.php?latex=%5Clambda%5E%2A&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda^*" title="&#92;lambda^*" class="latex" /> is the optimal value of <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda" title="&#92;lambda" class="latex" />. </p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=D_%7BKL%7D%5Cbigg%28+p%28x%7C%5Clambda%5E%2A%29+%7C%7C+p%28x%7C%5Clambda%29+%5Cbigg%29+%3D++E_%7Bp%28x%7C%5Clambda%29%7D%5Cbig%5B+log+%28p%28x%7C%5Clambda%5E%2A+%29%5Cbig%29+%5Cbig%5D+-+E_%7Bp%28x%7C%5Clambda%29%7D%5Cbig%5B+log+%28p%28x%7C%5Clambda+%29%5Cbig%29+%5Cbig%5D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="D_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) =  E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda^* )&#92;big) &#92;big] - E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda )&#92;big) &#92;big]" title="D_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) =  E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda^* )&#92;big) &#92;big] - E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda )&#92;big) &#92;big]" class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=%5Cnabla_%5Clambda%5E1+D_%7BKL%7D%5Cbigg%28+p%28x%7C%5Clambda%5E%2A%29+%7C%7C+p%28x%7C%5Clambda%29+%5Cbigg%29+%3D+%5Cnabla_%5Clambda%5E1+E_%7Bp%28x%7C%5Clambda%29%7D%5Cbig%5B+log+%28p%28x%7C%5Clambda%5E%2A+%29%5Cbig%29+%5Cbig%5D+-+%5Cnabla_%5Clambda%5E1+E_%7Bp%28x%7C%5Clambda%29%7D%5Cbig%5B+log+%28p%28x%7C%5Clambda%29%5Cbig%29+%5Cbig%5D+&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;nabla_&#92;lambda^1 D_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = &#92;nabla_&#92;lambda^1 E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda^* )&#92;big) &#92;big] - &#92;nabla_&#92;lambda^1 E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda)&#92;big) &#92;big] " title="&#92;nabla_&#92;lambda^1 D_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = &#92;nabla_&#92;lambda^1 E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda^* )&#92;big) &#92;big] - &#92;nabla_&#92;lambda^1 E_{p(x|&#92;lambda)}&#92;big[ log (p(x|&#92;lambda)&#92;big) &#92;big] " class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=%3D+-+E_%7Bp%28x%7C%5Clambda%29%7D%5Cbig%5B%5Cnabla_%5Clambda%5E1+log+%28p%28x%7C%5Clambda+%29%5Cbig%29+%5Cbig%5D+&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="= - E_{p(x|&#92;lambda)}&#92;big[&#92;nabla_&#92;lambda^1 log (p(x|&#92;lambda )&#92;big) &#92;big] " title="= - E_{p(x|&#92;lambda)}&#92;big[&#92;nabla_&#92;lambda^1 log (p(x|&#92;lambda )&#92;big) &#92;big] " class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=%5Cnabla_%5Clambda%5E2+D_%7BKL%7D%5Cbigg%28+p%28x%7C%5Clambda%5E%2A%29+%7C%7C+p%28x%7C%5Clambda%29+%5Cbigg%29+%3D+-+E_%7Bp%28x%7C%5Clambda%29%7D%5Cbig%5B%5Cnabla_%5Clambda%5E2+log+%28p%28x%7C%5Clambda%29%5Cbig%29+%5Cbig%5D+%3D+-+%5Cint+p%28x%7C%5Clambda%29+%5Cnabla_%5Clambda%5E2+log+%28p%28x%7C%5Clambda%29%5Cbig%29+dx&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;nabla_&#92;lambda^2 D_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = - E_{p(x|&#92;lambda)}&#92;big[&#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda)&#92;big) &#92;big] = - &#92;int p(x|&#92;lambda) &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda)&#92;big) dx" title="&#92;nabla_&#92;lambda^2 D_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = - E_{p(x|&#92;lambda)}&#92;big[&#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda)&#92;big) &#92;big] = - &#92;int p(x|&#92;lambda) &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda)&#92;big) dx" class="latex" /></p>



<p style="font-size:18px;">Evaluate <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda" title="&#92;lambda" class="latex" /> at <img src="https://s0.wp.com/latex.php?latex=%5Clambda%5E%2A&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda^*" title="&#92;lambda^*" class="latex" />:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=H_%7BKL%7D%5Cbigg%28+p%28x%7C%5Clambda%5E%2A%29+%7C%7C+p%28x%7C%5Clambda%29+%5Cbigg%29+%3D+-+%5Cint+p%28x%7C%5Clambda%29+%5Cnabla_%5Clambda%5E2+log+%28p%28x%7C%5Clambda%29%5Cbig%29+%5Cbig%7C_%7B%5Clambda%3D%5Clambda%5E%2A%7D+dx+%3D+-+%5Cint+p%28x%7C%5Clambda%5E%2A%29+%5Cnabla_%5Clambda%5E2+log+%28p%28x%7C%5Clambda%5E%2A%29%5Cbig%29+dx&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="H_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = - &#92;int p(x|&#92;lambda) &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda)&#92;big) &#92;big|_{&#92;lambda=&#92;lambda^*} dx = - &#92;int p(x|&#92;lambda^*) &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda^*)&#92;big) dx" title="H_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = - &#92;int p(x|&#92;lambda) &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda)&#92;big) &#92;big|_{&#92;lambda=&#92;lambda^*} dx = - &#92;int p(x|&#92;lambda^*) &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda^*)&#92;big) dx" class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=%3D+-E_%7Bp%28x%7C%5Clambda%5E%2A%29%7D%5Cbigg%5B+%5Cnabla_%5Clambda%5E2+log+%28p%28x%7C%5Clambda%5E%2A%29%5Cbig%29+%5Cbigg%5D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="= -E_{p(x|&#92;lambda^*)}&#92;bigg[ &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda^*)&#92;big) &#92;bigg]" title="= -E_{p(x|&#92;lambda^*)}&#92;bigg[ &#92;nabla_&#92;lambda^2 log (p(x|&#92;lambda^*)&#92;big) &#92;bigg]" class="latex" /></p>



<p style="font-size:18px;" class="has-text-align-center">Thus, <img src="https://s0.wp.com/latex.php?latex=H_%7BKL%7D%5Cbigg%28+p%28x%7C%5Clambda%5E%2A%29+%7C%7C+p%28x%7C%5Clambda%29+%5Cbigg%29+%3D+F_%7Bp%28x%7C%5Clambda%5E%2A%29%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="H_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = F_{p(x|&#92;lambda^*)}" title="H_{KL}&#92;bigg( p(x|&#92;lambda^*) || p(x|&#92;lambda) &#92;bigg) = F_{p(x|&#92;lambda^*)}" class="latex" /></p>



<ul><li><strong><em>Finding steepest points</em></strong></li></ul>



<p style="font-size:18px;">Let <img src="https://s0.wp.com/latex.php?latex=KL%28%5Clambda%27%29+%3D+D_%7BKL%7D%5Cbigg%28+p%28x%7C%5Clambda%27%29+%7C%7C+p%28x%7C%5Clambda%29%5Cbigg%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="KL(&#92;lambda&#039;) = D_{KL}&#92;bigg( p(x|&#92;lambda&#039;) || p(x|&#92;lambda)&#92;bigg)" title="KL(&#92;lambda&#039;) = D_{KL}&#92;bigg( p(x|&#92;lambda&#039;) || p(x|&#92;lambda)&#92;bigg)" class="latex" />. <img src="https://s0.wp.com/latex.php?latex=%5Clambda%5E%2A+%3D+%5Clambda+%2B+%5Cnabla+KL%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda^* = &#92;lambda + &#92;nabla KL(&#92;lambda)" title="&#92;lambda^* = &#92;lambda + &#92;nabla KL(&#92;lambda)" class="latex" />. Finding <img src="https://s0.wp.com/latex.php?latex=%5Clambda%5E%2A&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda^*" title="&#92;lambda^*" class="latex" /> means minimizing a function in distribution space:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=min+%5Cbig%5C%7BKL%28%5Clambda+%2B+%5Cnabla+KL%28%5Clambda%29%29%5Cbig%5C%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="min &#92;big&#92;{KL(&#92;lambda + &#92;nabla KL(&#92;lambda))&#92;big&#92;}" title="min &#92;big&#92;{KL(&#92;lambda + &#92;nabla KL(&#92;lambda))&#92;big&#92;}" class="latex" /></p>



<p style="font-size:18px;">With second-order Taylor Series:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=f%28x+%2B+dx%29+%5Capprox+f%28x%29+%2B+%5Cnabla+f%28x%29%5ET+%5CDelta+x++%2B+%5Cdfrac%7B1%7D%7B2%7D%5CDelta+x%5ET+H%28x%29%5CDelta+x&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="f(x + dx) &#92;approx f(x) + &#92;nabla f(x)^T &#92;Delta x  + &#92;dfrac{1}{2}&#92;Delta x^T H(x)&#92;Delta x" title="f(x + dx) &#92;approx f(x) + &#92;nabla f(x)^T &#92;Delta x  + &#92;dfrac{1}{2}&#92;Delta x^T H(x)&#92;Delta x" class="latex" /></p>



<p style="font-size:18px;">Let <img src="https://s0.wp.com/latex.php?latex=d+%3D+%5Cnabla+KL%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="d = &#92;nabla KL(&#92;lambda)" title="d = &#92;nabla KL(&#92;lambda)" class="latex" />. We have:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=KL+%28%5Clambda%5E%2A%29+%3D+KL%28%5Clambda+%2B+d%29+%5Capprox+KL%28%5Clambda%29+%2B+%5Cnabla+KL%28%5Clambda%29%5ETd+%2B+%5Cdfrac%7B1%7D%7B2%7Dd%5ET+F+d+&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="KL (&#92;lambda^*) = KL(&#92;lambda + d) &#92;approx KL(&#92;lambda) + &#92;nabla KL(&#92;lambda)^Td + &#92;dfrac{1}{2}d^T F d " title="KL (&#92;lambda^*) = KL(&#92;lambda + d) &#92;approx KL(&#92;lambda) + &#92;nabla KL(&#92;lambda)^Td + &#92;dfrac{1}{2}d^T F d " class="latex" /></p>



<p style="font-size:18px;"><img src="https://s0.wp.com/latex.php?latex=KL%28%5Clambda%29+%3D+0&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="KL(&#92;lambda) = 0" title="KL(&#92;lambda) = 0" class="latex" /> because it is the distance from <img src="https://s0.wp.com/latex.php?latex=%5Clambda&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda" title="&#92;lambda" class="latex" /> to itself, thus:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=KL+%28%5Clambda%5E%2A%29+%3D+KL%28%5Clambda%2Bd%29+%5Capprox+%5Cdfrac%7B1%7D%7B2%7Dd%5ET+F+d+&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="KL (&#92;lambda^*) = KL(&#92;lambda+d) &#92;approx &#92;dfrac{1}{2}d^T F d " title="KL (&#92;lambda^*) = KL(&#92;lambda+d) &#92;approx &#92;dfrac{1}{2}d^T F d " class="latex" /></p>



<p style="font-size:18px;">To find <img src="https://s0.wp.com/latex.php?latex=%5Clambda%5E%2A&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;lambda^*" title="&#92;lambda^*" class="latex" />, corresponding to minimizing the loss function <img src="https://s0.wp.com/latex.php?latex=KL&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="KL" title="KL" class="latex" />, we minimize the <img src="https://s0.wp.com/latex.php?latex=L+%3D+-log+p%28x%7C%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L = -log p(x|&#92;lambda)" title="L = -log p(x|&#92;lambda)" class="latex" />: </p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=min+%5Cbig%5C%7BL%28%5Clambda+%2B+%5Cnabla+L%28%5Clambda%29%29%5Cbig%5C%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="min &#92;big&#92;{L(&#92;lambda + &#92;nabla L(&#92;lambda))&#92;big&#92;}" title="min &#92;big&#92;{L(&#92;lambda + &#92;nabla L(&#92;lambda))&#92;big&#92;}" class="latex" /></p>



<p style="font-size:18px;">Let <img src="https://s0.wp.com/latex.php?latex=%5Chat%7Bd%7D+%3D%5Cnabla+L%28%5Clambda%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;hat{d} =&#92;nabla L(&#92;lambda)" title="&#92;hat{d} =&#92;nabla L(&#92;lambda)" class="latex" />. It was proved that <img src="https://s0.wp.com/latex.php?latex=L%28%5Clambda+%2B%5Chat%7Bd%7D%29+%3D+min+%5Ciff+%5Chat%7Bd%7D+%3D+KL+%28%5Clambda%5E%2A%29&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="L(&#92;lambda +&#92;hat{d}) = min &#92;iff &#92;hat{d} = KL (&#92;lambda^*)" title="L(&#92;lambda +&#92;hat{d}) = min &#92;iff &#92;hat{d} = KL (&#92;lambda^*)" class="latex" />:</p>



<p style="font-size:18px;" class="has-text-align-center"><img src="https://s0.wp.com/latex.php?latex=%5Chat%7Bd%7D+%3D+KL+%28%5Clambda%5E%2A%29+%5CRightarrow+d+%3D+F%5E%7B-1%7D%5Chat%7Bd%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;hat{d} = KL (&#92;lambda^*) &#92;Rightarrow d = F^{-1}&#92;hat{d}" title="&#92;hat{d} = KL (&#92;lambda^*) &#92;Rightarrow d = F^{-1}&#92;hat{d}" class="latex" />  or <img src="https://s0.wp.com/latex.php?latex=%5Chat%5Cnabla_%5Ctheta%7BL%7D+%3D+F%5E%7B-1%7D%5Cnabla_%5Ctheta%7BL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;hat&#92;nabla_&#92;theta{L} = F^{-1}&#92;nabla_&#92;theta{L}" title="&#92;hat&#92;nabla_&#92;theta{L} = F^{-1}&#92;nabla_&#92;theta{L}" class="latex" />.</p>



<p style="font-size:18px;">The term <img src="https://s0.wp.com/latex.php?latex=%5Chat%5Cnabla_%5Ctheta%7BL%7D+%3D+F%5E%7B-1%7D%5Cnabla_%5Ctheta%7BL%7D&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="&#92;hat&#92;nabla_&#92;theta{L} = F^{-1}&#92;nabla_&#92;theta{L}" title="&#92;hat&#92;nabla_&#92;theta{L} = F^{-1}&#92;nabla_&#92;theta{L}" class="latex" /> is called natural gradient. In fact, <img src="https://s0.wp.com/latex.php?latex=F&#038;bg=ffffff&#038;fg=404040&#038;s=0&#038;c=20201002" alt="F" title="F" class="latex" /> is a Riemannian metric performing transformation from distribution space to Euclidean space.</p>



<p style="font-size:18px;">More detail in explaining natural gradient descent, check out <a href="https://wiseodd.github.io/techblog/2018/03/14/natural-gradient/"><em><strong>here</strong></em></a>.</p>



<h2>4. Stochastic Variational Inference (SVI)</h2>



<p style="font-size:18px;">SVI was inspired by Stochastic Gradient Descent, which separates the training set into many sub-set and feeds data to neural network with smaller size. This is helpful to save resource usage so that SVI is highly scalable while traditional method could fail to be trained because of loading full size of data. The challange of SVI is how to approximate the natural gradients of full data by natural gradients of small sub-set. They introduce global and local parameters for all hidden variables, including all latent variables and all their parameters. The global holds natural gradients of full dataset, while the local saves natural gradients of current sub-set. </p>



<h2>Summary</h2>



<p style="font-size:18px;">Variational Inference methods use hidden variables to encode hidden structure in observed data. The relationship between the hidden variables and observations is factorized by joint probability distribution. Therefore, to sample observations, we estimate the posterior distribution (the conditional distribution of the hidden structure given the observations). This posterior could be not tractable to compute and we must appeal to approximate methods, thus approximating problem becomes optimization problem.</p>



<p style="font-size:18px;">While dealing with the optimization task, KL divergence is used as a distance metric. But we do not minimize it. Instead, ELBO, which has close relation to KL divergence, provides an easier way to reach global optimum by iteratively increasing the lower bound. This step is done by coordinate descent or gradient descent to find the steepest points of factors.</p>



<p style="font-size:18px;">Another important theorem is mean-field variational inference. It allows approximating complicated structure of distributions and also is easier to track. Then each factor can be updated independently by steepest descent algorithms.</p>



<p style="font-size:18px;">These algorithms are difficult to find optimal points without assisting of the natural gradient since parameters are in Euclidean space while distance metric is in distribution space. Fisher information matrix, a transformation between two kinds of space, is a key contribution of natural gradient.</p>



<p style="font-size:18px;">Finally, Stochastic Variational Inference inherits ideas of Stochastic Gradient Descent and proposes terms of global and local parameters. They respectively hold full-batch gradients and mini-batch gradients of models. SVI achieves in improving the scalability of methods, making Variational Inference methods more wide-known today.</p>



<p></p>
<div id="jp-post-flair" class="sharedaddy sd-rating-enabled sd-like-enabled sd-sharing-enabled"><div class="sd-block sd-rating"><h3 class="sd-title">Rate this:</h3><div class="cs-rating pd-rating" id="pd_rating_holder_8831506_post_1024"></div></div><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-press-this"><a rel="nofollow noopener noreferrer" data-shared="" class="share-press-this sd-button share-icon" href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/?share=press-this" target="_blank" title="Click to Press This!"><span>Press This</span></a></li><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-1024" class="share-twitter sd-button share-icon" href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-1024" class="share-facebook sd-button share-icon" href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-end"></li></ul><p class="share-customize-link"><a href="https://jetpack.com/redirect/?source=calypso-marketing-sharing-buttons&#038;site=langocthuyan.wordpress.com" target="_blank" rel="noopener noreferrer">Customize buttons</a></p></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-60408846-1024-5f98431f607bd' data-src='//widgets.wp.com/likes/index.html?ver=20200826#blog_id=60408846&amp;post_id=1024&amp;origin=langocthuyan.wordpress.com&amp;obj_id=60408846-1024-5f98431f607bd' data-name='like-post-frame-60408846-1024-5f98431f607bd'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="https://langocthuyan.wordpress.com/category/collections/data-science/" rel="category tag">Data Science</a>, <a href="https://langocthuyan.wordpress.com/category/collections/data-science/learning/" rel="category tag">Learning</a>, <a href="https://langocthuyan.wordpress.com/category/collections/data-science/learning/statistical-approach/" rel="category tag">Statistical approach</a></span><span class="tags-links">Tagged <a href="https://langocthuyan.wordpress.com/tag/svi/" rel="tag">#SVI</a>, <a href="https://langocthuyan.wordpress.com/tag/approximating/" rel="tag">approximating</a>, <a href="https://langocthuyan.wordpress.com/tag/bayesian/" rel="tag">bayesian</a>, <a href="https://langocthuyan.wordpress.com/tag/inference/" rel="tag">inference</a>, <a href="https://langocthuyan.wordpress.com/tag/kl-divergence/" rel="tag">KL-divergence</a>, <a href="https://langocthuyan.wordpress.com/tag/mean-field/" rel="tag">mean-field</a>, <a href="https://langocthuyan.wordpress.com/tag/natural-gradient/" rel="tag">natural-gradient</a>, <a href="https://langocthuyan.wordpress.com/tag/posterior/" rel="tag">posterior</a>, <a href="https://langocthuyan.wordpress.com/tag/prior/" rel="tag">prior</a>, <a href="https://langocthuyan.wordpress.com/tag/variational/" rel="tag">variational</a>, <a href="https://langocthuyan.wordpress.com/tag/variational-inference/" rel="tag">variational-inference</a></span><span class="edit-link"><a class="post-edit-link" href="https://wordpress.com/post/langocthuyan.wordpress.com/1024">Edit <span class="screen-reader-text">Variational Inference algorithm</span></a></span>	</footer><!-- .entry-footer -->

	</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://langocthuyan.wordpress.com/2020/03/23/getting-started-with-bayesian-inference/" rel="prev"><span class="meta-nav">Previous Post</span> Getting started with Bayesian&nbsp;Inference</a></div><div class="nav-next"><a href="https://langocthuyan.wordpress.com/2020/04/20/neural-algorithm-of-artistic-style-transfer-understanding-and-examples-with-pytorch/" rel="next"><span class="meta-nav">Next Post</span> Neural Algorithm of Artistic Style Transfer: Understanding with PyTorch&nbsp;examples</a></div></div>
	</nav>
			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2020/03/24/variational-inference-algorithm/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://langocthuyan.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="86c4687156" /><input type="hidden" name="_wp_http_referer" value="/2020/03/24/variational-inference-algorithm/" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="wordpress" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">
	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" class="nascar-signin-link"
                   title="Login via Guest">
									</a>
			</li>
			<li class="selected">
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" class="nascar-signin-link"
                   title="Login via WordPress.com">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"/></g></svg>				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=https%3A%2F%2Flangocthuyan.wordpress.com&#038;color_scheme=light" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" class="nascar-signin-link"
                   title="Login via Twitter">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"/></g></svg>				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" class="nascar-signin-link"
                   title="Login via Facebook">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"/></g></svg>				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url" value="" /></div>
				</div>
			</div>
			
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/d24262009cdf6377d9201d1c165f989d?s=25&amp;d=https%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D25%26amp%3Bd%3Didenticon%26amp%3Bforcedefault%3Dy%26amp%3Br%3DG&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="https://1.gravatar.com/avatar/d24262009cdf6377d9201d1c165f989d?s=25&#038;d=https%3A%2F%2Fs0.wp.com%2Fwp-content%2Fmu-plugins%2Fhighlander-comments%2Fimages%2Fwplogo.png&#038;r=G" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="57803787" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="bfe1c555bef916d8ce1c4c8d3be0842b861bdbca" />
						<p class="comment-form-posting-as pa-wordpress">
			<strong>An La:</strong>
			You are commenting using your WordPress.com account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"/></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
						<p class="comment-form-posting-as pa-googleplus">
			<strong></strong>
			You are commenting using your Google account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" x="0px" y="0px" viewBox="0 0 60 60" ><path fill="#519bf7" d="M56.3,30c0,-1.6 -0.2,-3.4 -0.6,-5h-3.1H42.2H30v10.6h14.8C44,39.3 42,42 39.1,43.9l8.8,6.8C53,46 56.3,39 56.3,30z" /><path fill="#3db366" d="M30,57.5c6.7,0 13.1,-2.4 17.9,-6.8l-8.8,-6.8c-2.5,1.6 -5.6,2.4 -9.1,2.4c-7.2,0 -13.3,-4.7 -15.4,-11.2l-9.3,7.1C9.8,51.3 19.1,57.5 30,57.5z" /><path fill="#fdc600" d="M5.3,42.2l9.3,-7.1c-0.5,-1.6 -0.8,-3.3 -0.8,-5.1s0.3,-3.5 0.8,-5.1l-9.3,-7.1C3.5,21.5 2.5,25.6 2.5,30S3.5,38.5 5.3,42.2z" /><path fill="#f15b44" d="M40.1,17.4l8,-8C43.3,5.1 37,2.5 30,2.5C19.1,2.5 9.8,8.7 5.3,17.8l9.3,7.1c2.1,-6.5 8.2,-11.1 15.4,-11.1C33.9,13.7 37.4,15.1 40.1,17.4z" /></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
						<p class="comment-form-posting-as pa-twitter">
			<strong></strong>
			You are commenting using your Twitter account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"/></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
						<p class="comment-form-posting-as pa-facebook">
			<strong></strong>
			You are commenting using your Facebook account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"/></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog"  style="display: inline;">Notify me of new posts via email.</label></p></div>

<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1024' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a4480b7a0c" /></p>
<input type="hidden" name="genseq" value="1603814175" />
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="218"/></p><p style="display: none;"><input type="text" name="ak_hp_text" value="" autocomplete="off" /><input type="email" name="ak_hp_email" value="" autocomplete="off" /><input type="phone" name="ak_hp_phone" value="" autocomplete="off" /><input type="url" name="ak_hp_url" value="" autocomplete="off" /><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="65525"></textarea></p></form>	</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
	<aside id="categories-13" class="widget widget_categories"><h2 class="widget-title">Categories</h2><form action="https://langocthuyan.wordpress.com" method="get"><label class="screen-reader-text" for="cat">Categories</label><select  name='cat' id='cat' class='postform' >
	<option value='-1'>Select Category</option>
	<option class="level-0" value="12763">Collections&nbsp;&nbsp;(8)</option>
	<option class="level-1" value="21818323">&nbsp;&nbsp;&nbsp;Data Science&nbsp;&nbsp;(8)</option>
	<option class="level-2" value="264">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Learning&nbsp;&nbsp;(6)</option>
	<option class="level-3" value="36396399">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Statistical approach&nbsp;&nbsp;(3)</option>
	<option class="level-3" value="317">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Techniques&nbsp;&nbsp;(2)</option>
	<option class="level-2" value="24361">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Practice&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="1035">Other&nbsp;&nbsp;(5)</option>
	<option class="level-1" value="2514">&nbsp;&nbsp;&nbsp;Archive&nbsp;&nbsp;(2)</option>
	<option class="level-1" value="42308953">&nbsp;&nbsp;&nbsp;Competitive Programming&nbsp;&nbsp;(3)</option>
</select>
</form>
<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

			</aside><aside id="top-posts-12" class="widget widget_top-posts"><h2 class="widget-title">Top Posts &amp; Pages</h2><ul>				<li>
					<a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/" class="bump-view" data-bump-view="tp">Kĩ thuật sử dụng Deque tìm Min/Max trên đoạn tịnh tiến</a>					</li>
								<li>
					<a href="https://langocthuyan.wordpress.com/2020/04/20/neural-algorithm-of-artistic-style-transfer-understanding-and-examples-with-pytorch/" class="bump-view" data-bump-view="tp">Neural Algorithm of Artistic Style Transfer: Understanding with PyTorch examples</a>					</li>
								<li>
					<a href="https://langocthuyan.wordpress.com/2013/12/09/vai-van-de-lien-quan-den-latex-con-chinh-sua/" class="bump-view" data-bump-view="tp">Vài vấn đề liên quan đến Latex</a>					</li>
								<li>
					<a href="https://langocthuyan.wordpress.com/2020/04/26/shortest-subarray-with-sum-at-least-k/" class="bump-view" data-bump-view="tp">Shortest Subarray with Sum at Least K</a>					</li>
				</ul></aside>
		<aside id="recent-posts-12" class="widget widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2>
		<ul>
											<li>
					<a href="https://langocthuyan.wordpress.com/2020/04/26/shortest-subarray-with-sum-at-least-k/">Shortest Subarray with Sum at Least&nbsp;K</a>
									</li>
											<li>
					<a href="https://langocthuyan.wordpress.com/2020/04/20/neural-algorithm-of-artistic-style-transfer-understanding-and-examples-with-pytorch/">Neural Algorithm of Artistic Style Transfer: Understanding with PyTorch&nbsp;examples</a>
									</li>
											<li>
					<a href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/" aria-current="page">Variational Inference algorithm</a>
									</li>
											<li>
					<a href="https://langocthuyan.wordpress.com/2020/03/23/getting-started-with-bayesian-inference/">Getting started with Bayesian&nbsp;Inference</a>
									</li>
											<li>
					<a href="https://langocthuyan.wordpress.com/2020/03/15/jensens-inequality-and-applications-em-algorithm-and-elbo-in-svi/">Jensen’s inequality and applications: EM Algorithm and ELBO in&nbsp;SVI</a>
									</li>
					</ul>

		</aside></div><!-- #secondary -->

		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
			
				<div class="footer-widgets clear">

					
						<div class="widget-area">

							<aside id="blog-stats-12" class="widget widget_blog-stats"><h2 class="widget-title">Blog Stats</h2>		<ul>
			<li>10,441 hits</li>
		</ul>
		</aside><aside id="follow_button_widget-10" class="widget widget_follow_button_widget">
		<a class="wordpress-follow-button" href="https://langocthuyan.wordpress.com" data-blog="60408846" data-lang="en" >Follow An La (Yên Vũ) on WordPress.com</a>
		<script type="text/javascript">(function(d){var f = d.getElementsByTagName('SCRIPT')[0], p = d.createElement('SCRIPT');p.type = 'text/javascript';p.async = true;p.src = '//widgets.wp.com/platform.js';f.parentNode.insertBefore(p,f);}(document));</script>

		</aside><aside id="blog_subscription-10" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title"><label for="subscribe-field">Follow Blog via Email</label></h2>
			<form
				action="https://subscribe.wordpress.com"
				method="post"
				accept-charset="utf-8"
				id=""
			>
									<p>Click to follow this blog and receive notifications of new posts by email.</p>
						<div class="jetpack-subscribe-count">
							<p>
							Join 4 other followers							</p>
						</div>
										
				<p id="subscribe-submit">
                    <input type="hidden" name="action" value="subscribe"/>
                    <input type="hidden" name="blog_id" value="60408846"/>
                    <input type="hidden" name="source" value="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/"/>
                    <input type="hidden" name="sub-type" value="widget"/>
                    <input type="hidden" name="redirect_fragment" value="blog_subscription-10"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="c79ef866ba" />                    <button type="submit"
	                    		                	                >
	                    Follow                    </button>
                </p>
            </form>
			
</aside>
						</div><!-- .widget-area -->

					
					
					
						<div class="widget-area">

							<aside id="top-posts-15" class="widget widget_top-posts"><h2 class="widget-title">Top Posts &amp; Pages</h2><ul>				<li>
					<a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/" class="bump-view" data-bump-view="tp">Kĩ thuật sử dụng Deque tìm Min/Max trên đoạn tịnh tiến</a>					</li>
								<li>
					<a href="https://langocthuyan.wordpress.com/2020/04/20/neural-algorithm-of-artistic-style-transfer-understanding-and-examples-with-pytorch/" class="bump-view" data-bump-view="tp">Neural Algorithm of Artistic Style Transfer: Understanding with PyTorch examples</a>					</li>
								<li>
					<a href="https://langocthuyan.wordpress.com/2013/12/09/vai-van-de-lien-quan-den-latex-con-chinh-sua/" class="bump-view" data-bump-view="tp">Vài vấn đề liên quan đến Latex</a>					</li>
				</ul></aside><aside id="recent-comments-12" class="widget widget_recent_comments"><h2 class="widget-title">Recent Comments</h2>				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="Huy" class="recentcommentsavatartop" style="height:48px; width:48px;"><img alt='' src='https://2.gravatar.com/avatar/28eb4b2fd518b395e49dc3cb9ae70d36?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstexttop" style="">Huy on <a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/comment-page-1/#comment-47">Kĩ thuật sử dụng Deque tìm Min&hellip;</a></td></tr><tr><td title="Khôi" class="recentcommentsavatarend" style="height:48px; width:48px;"><img alt='' src='https://1.gravatar.com/avatar/78f0bc89bb9a83601aaa6fa53c98a3bc?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstextend" style="">Khôi on <a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/comment-page-1/#comment-35">Kĩ thuật sử dụng Deque tìm Min&hellip;</a></td></tr><tr><td title="Tên A" class="recentcommentsavatarend" style="height:48px; width:48px;"><img alt='' src='https://2.gravatar.com/avatar/e23851629765c2c486d39d04e0af9d41?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstextend" style="">Tên A on <a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/comment-page-1/#comment-22">Kĩ thuật sử dụng Deque tìm Min&hellip;</a></td></tr><tr><td title="taquy2000" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="http://gravatar.com/taquy2000" rel="nofollow"><img alt='' src='https://1.gravatar.com/avatar/1bfcdd14d9380d5837a2ece05446e9b1?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></a></td><td class="recentcommentstextend" style=""><a href="http://gravatar.com/taquy2000" rel="nofollow">taquy2000</a> on <a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/comment-page-1/#comment-20">Kĩ thuật sử dụng Deque tìm Min&hellip;</a></td></tr><tr><td title="Ứng dụng Deque để tìm Min, Max trên đoạn bất kì của dãy số | Nhan Nguyen thanh" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="https://nhannguyen95.wordpress.com/2016/01/10/ung-dung-deque-de-tim-min-max-tren-doan-bat-ki-cua-day-so/" rel="nofollow"></a></td><td class="recentcommentstextend" style=""><a href="https://nhannguyen95.wordpress.com/2016/01/10/ung-dung-deque-de-tim-min-max-tren-doan-bat-ki-cua-day-so/" rel="nofollow">Ứng dụng Deque để tì&hellip;</a> on <a href="https://langocthuyan.wordpress.com/2014/08/12/ki-thuat-su-dung-deque-stack-2-dau-tim-minmax-tren-doan-tinh-tien/comment-page-1/#comment-18">Kĩ thuật sử dụng Deque tìm Min&hellip;</a></td></tr>				</table>
				</aside>
						</div><!-- .widget-area -->

					
				</div><!-- .footer-widgets -->

			
			<div class="site-info">
				<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->
</div><!-- .site-wrapper -->

<!--  -->
	<script type="text/javascript">
	/* <![CDATA[ */
		jQuery(document).ready( function($) {
			function doFollowingHover() {
				$('#wp-admin-bar-follow > a').unbind( '.unfollow' );

				$('#wp-admin-bar-follow > a').bind( 'mouseover.unfollow', function() {

					$(this).html( "Unfollow" ).parent( 'li' ).addClass( 'unfollow' );
				});
				$('#wp-admin-bar-follow > a').bind( 'mouseout.unfollow', function() {
					$(this).html( "Following" ).parent( 'li' ).removeClass( 'unfollow' );
				});
			}
							doFollowingHover();
			
			$('#wp-admin-bar-follow > a').click( function( e ) {
				$('#wp-admin-bar-follow > a').unbind( '.unfollow' );

				e.preventDefault();

				var link = $( this ), li = $( '#wp-admin-bar-follow' ), timeout = 0;

				if ( li.hasClass( 'subscribed' ) ) {
					li.removeClass( 'subscribed' ).removeClass( 'unfollow' );
					link.html( "Follow" );

					$('body').append( $( 'div.wpcom-bubble' ).removeClass( 'fadein' ) ).off( 'click.bubble' );

					var action = 'ab_unsubscribe_from_blog';
				} else {
					li.addClass( 'subscribed' ).removeClass( 'unfollow' );
					link.html( "Following" );

						var left = 131 - link.width();
						li.append( $( 'div.wpcom-bubble' ).css( { left: '-' + left + 'px' } ) );
						$( 'div.bubble-txt', 'div.wpcom-bubble' ).html( "New posts from this blog will now appear in \u003Ca target=\u0022_blank\u0022 href=\u0022http:\/\/wordpress.com\/\u0022\u003Eyour reader\u003C\/a\u003E. You can manage email alerts from your \u003Ca target=\u0022_blank\u0022 href=\u0022http:\/\/wordpress.com\/following\/edit\/\u0022\u003Esubscriptions page\u003C\/a\u003E." );

						$( 'div.wpcom-bubble.action-bubble' ).addClass( 'fadein' );

						setTimeout( function() {
							$('body').on( 'click.bubble touchstart.bubble', function(e) {
								if ( !$(e.target).hasClass('wpcom-bubble') && !$(e.target).parents( 'div.wpcom-bubble' ).length )
									hideBubble();
							});
							setTimeout( hideBubble, 15000 );
						}, 500 );

					var action = 'ab_subscribe_to_blog';
					$('#wp-admin-bar-follow > a').bind( 'mouseout.shift', function() {
						doFollowingHover();
						$(this).unbind( '.shift' );
					});
				}

				var nonce = link.attr( 'href' ).split( '_wpnonce=' );
				nonce = nonce[1];

				$.post( "https:\/\/langocthuyan.wordpress.com\/wp-admin\/admin-ajax.php", {
					'action': action,
					'_wpnonce': nonce,
					'source': 'admin_bar',
					'blog_id': 60408846				});
			});
		});
	/* ]]> */
	</script>
<script src='//0.gravatar.com/js/gprofiles.js?ver=202044y' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":"d24262009cdf6377d9201d1c165f989d"};
</script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-28eb4b2fd518b395e49dc3cb9ae70d36">
	</div>
	<div class="grofile-hash-map-78f0bc89bb9a83601aaa6fa53c98a3bc">
	</div>
	<div class="grofile-hash-map-e23851629765c2c486d39d04e0af9d41">
	</div>
	<div class="grofile-hash-map-1bfcdd14d9380d5837a2ece05446e9b1">
	</div>
	</div>

	<div id="ab-reblog-box">
		<form action="" name="reblog">
			<textarea id="reblog-content" name="reblog-content" placeholder="Add your thoughts here... (optional)"></textarea>
			<label for="blogid" id="lblogid">Post to</label>

			<select name="to_blog_id" id="reblog-to-blog-id">
														<option value="60408846">An La (Yên Vũ)</option>
														<option value="123003941">Bao Nguyen</option>
														<option value="60593356">Yên Vũ</option>
							</select>

			<div class="submit">
				<span class="canceltext"><a href="" class="cancel">Cancel</a></span>
				<input type="submit" name="reblog-submit" class="button-primary" id="reblog-submit" value="Reblog Post" />
				<input type="hidden" id="original-blog-id" value="60408846" />
				<input type="hidden" id="original-post-id" value="1024" />
			</div>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="b9597715ec" /><input type="hidden" name="_wp_http_referer" value="/2020/03/24/variational-inference-algorithm/" />		</form>

		<div class="arrow"></div>
	</div>

	<script type="text/javascript">
	var wpcom_reblog = {
		request: false,
		source: 'toolbar',

		init: function() {
			// Click reblog button on post
			jQuery(document).on( 'click', '#wpadminbar .reblog', function(e) {
				e.preventDefault();
				wpcom_reblog.source = 'toolbar';

				if ( jQuery( '#wpadminbar #ab-reblog-box' ).is( ':visible' ) ) {
					wpcom_reblog.cancel_reblog();
				}
				else {
					wpcom_reblog.show_reblog_box();
				}
			} );

			// Clicked reblog button on already reblogged post.
			jQuery(document).on( 'click', '#wpadminbar .reblogged', function(e) {
				e.preventDefault();
			});

			// Click cancel reblog button
			jQuery(document).on( 'click', '#ab-reblog-box a.cancel', function(e) {
				e.preventDefault();
				wpcom_reblog.cancel_reblog();
			});

			// Submit reblog box
			jQuery(document).on( 'click', '#ab-reblog-box input[type=submit]', function(e) {
				e.preventDefault();
				wpcom_reblog.submit_reblog( jQuery(this) );
			});
		},

		show_reblog_box: function() {
			return this.show_reblog_box_here(
				'#wp-admin-bar-wpr-reblog',
				'#wpadminbar'
			);
		},

		toggle_reblog_box_flair: function( obj_id ) {
			if ( jQuery( '#jp-post-flair #ab-reblog-box' ).is( ':visible' ) ) {
				wpcom_reblog.cancel_reblog();
			}
			else {
				wpcom_reblog.show_reblog_box_flair( obj_id );
			}
		},

		show_reblog_box_flair: function( obj_id ) {
			this.source = 'post_flair';
			this.obj_id = obj_id;
			return this.show_reblog_box_here(
				'.post-likes-widget',
				'body'
			);
		},

		show_reblog_box_here: function(anchorId, parentId) {
			var jq = jQuery,
			    $anchor = jq( anchorId ),
			    $parent = jq( parentId ),
			    $window = jq( window ),
			    $scroll = jq('html, body'),
			    $reblog_box = jq( '#ab-reblog-box' ),
			    offset = $anchor.offset(),
			    left = offset.left + 'px',
			    width = '500px',
			    position,
			    top;

			if ( $parent.css( 'position' ) === 'fixed' ) {
				position = 'fixed';
				top = $parent.position().top + $parent.outerHeight();
			}
			else {
				position = 'absolute';
				top = offset.top + $anchor.outerHeight() + 'px';
			}
			$reblog_box.remove();
			$parent.append( $reblog_box );
			$anchor.addClass( 'selected' );

			if ( jq( window ).innerWidth() < offset.left + 500 ) {
				// Most likely mobile or tablet
				left = '0px';
				width = ( jq( window ).innerWidth() - 24 ) + 'px';
			}

			$reblog_box
				.find('p.response').remove().end()
				.find('div.submit, div.submit span.canceltext').show().end()
				.find('div.submit input[type=submit]').prop('disabled',false).end()
				.show()
				.css({
					top : top,
					left : left,
					width : width,
					position: position,
					'z-index': 10 // slide under twentyfourteen's fixed-positioned masthead
				});

			// Ensure we can see the whole reblog box
			var docViewTop = $window.scrollTop(),
			    windowHeight = $window.height(),
			    docViewBottom = docViewTop + windowHeight,
			    elemTop = $reblog_box.offset().top,
			    elemHeight = $reblog_box.outerHeight() + 10,
			    elemBottom = elemTop + elemHeight;
			if ( docViewTop > elemTop ) {
				// Need to scroll up
				// leave 75px for toolbar + Reblog button + margin
				$scroll.animate({scrollTop: elemTop - 75});
			}
			else if ( docViewBottom < elemBottom ) {
				// Need to scroll down
				$scroll.animate({scrollTop: elemBottom - windowHeight}, 100);
			}
		},

		submit_reblog: function( input ) {
			var jq = jQuery;
			var self = this;
			if ( typeof this.request == 'object' )
				this.request.abort();

			input.attr( 'value', 'Reblogging...' );
			input.prop( 'disabled', true );

			jq( '#ab-reblog-box div.submit span.canceltext' ).fadeOut( 150, function() {
				input.before( '<span class="spinner"></span>' );
			});

			var note = jq('#ab-reblog-box textarea').val();

			if ( jq('#default-reblog-note').val() == note )
				note = "";

			this.request = jq.get( '/wp-admin/admin-ajax.php', {
				'action': 'post_reblog',
				'original_blog_id': jq('#original-blog-id').val(),
				'original_post_id': jq('#original-post-id').val(),
				'blog_id': jq('#ab-reblog-box select').val(),
				'note': note,
				'_wpnonce': jq('#ab-reblog-box #_wpnonce').val(),
				'reblog_source': this.source
			},
			function(result, status, jqxhr) {
				if ( ! ( "type" in result ) ) {
					alert( "Error: " + jqxhr.responseText );
				}
				else if ( "error" == result.type ) {
					alert( result.message );
				}
				else {
					if ( typeof pm === 'function' ) {
						console.log(self);
						pm({
							target : window.frames['likes-master'],
							type : 'likesMessage',
							data : { event: 'didReblog', obj_id: self.obj_id },
							origin : '*'
						});
					}

					jq( '#ab-reblog-box' ).hide();
					jq( '#wp-admin-bar-wpr-reblog' ).addClass( 'reblogged' ).removeClass( 'reblog' ).find( 'a:first' ).text( 'Reblogged' );
				}
			}, 'json' );
		},

		cancel_reblog: function() {
			jQuery( '#ab-reblog-box' ).hide();
			jQuery( '#wp-admin-bar-wpr-reblog' ).removeClass( 'selected' );
		}
	};

	wpcom_reblog.init();
	</script>
<div id="report-form-window" style="display:none;"></div><script id='highlander-comments-js-extra'>
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/langocthuyan.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/langocthuyan.wordpress.com\/wp-login.php?action=logout&_wpnonce=188969057c","homeURL":"https:\/\/langocthuyan.wordpress.com\/","postID":"1024","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"1","isJetpack":"","text_direction":"ltr"};
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1573483029j'></script>

<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20201002";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20201002";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

	
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/langocthuyan.wordpress.com\/2020\/03\/24\/variational-inference-algorithm\/":1024};
	</script>
				<div class="widget widget_eu_cookie_law_widget">
<div
	class="hide-on-button ads-active"
	data-hide-timeout="30"
	data-consent-expiration="180"
	id="eu-cookie-law"
>
	<form method="post">
		<input type="submit" value="Close and accept" class="accept" />

		Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br />
To find out more, including how to control cookies, see here:
				<a href="https://automattic.com/cookies" rel="nofollow">
			Cookie Policy		</a>
 </form>
</div>
</div><script type='text/javascript' src='https://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzgioLMnIzwOaaJ9ra2hqbmBkYGJpYZoFAFs3QQg='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script id='thickbox-js-extra'>
var thickboxL10n = {"next":"Next >","prev":"< Prev","image":"Image","of":"of","close":"Close","noiframes":"This feature requires inline frames. You have iframes disabled or your browser does not support them.","loadingAnimation":"https:\/\/s0.wp.com\/wp-includes\/js\/thickbox\/loadingAnimation.gif"};
</script>
<script id='comment-like-js-extra'>
var comment_like_text = {"loading":"Loading..."};
</script>
<script id='libre-2-script-js-extra'>
var libreadminbar = ["1"];
</script>
<script id='notes-rest-common-js-extra'>
var wpNotesArgs = {"cacheBuster":"@automattic\/jetpack-blocks@13.1.0-10108-gb64426e4ba","iframeUrl":"https:\/\/widgets.wp.com\/notifications\/","iframeAppend":"2","iframeScroll":"no","wide":"1"};
</script>
<script id='tos-report-form-js-extra'>
var wpcom_tos_report_form = {"ajaxurl":"\/wp-admin\/admin-ajax.php","isLoggedoutUser":"","post_ID":"1024","current_url":"https:\/\/langocthuyan.wordpress.com\/2020\/03\/24\/variational-inference-algorithm","report_this_content":"Report this content"};
</script>
<script id='wordads-preview-js-extra'>
var wordads_preview = {"ajaxurl":"https:\/\/langocthuyan.wordpress.com\/wp-admin\/admin-ajax.php","blog_id":"60408846","user":"anvy1102","nonce":"aeef391dbd"};
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFU9lywyAM/KFi0mSaTh86/ZQOxootm6sI7KRfX8gdhyYvPthdtFoEnxyT1gQwgffEGxhRgttWPb3wW8hZChqIRAsnFI1UsQHKcOhQDrXdnj8KW/Q/Efzu+KrQjAjTU1oPwQk5MA+EvzCn68icii0a4gqHZCWJInTCNAp8yWdnR/C4F7OeKo2mxBJNAlgt/DWhUPPMS7i0ml10/2sST+fqB799Nl5zmtA9au5OdLMwF4YO0lFxF+u8uQe2PNbxdzXKVCNGbEVAe9d8mU8DumTFDGxjZSS2wW0p1pNpD07tnkQ7YdNCIA4xoXZAYEpMPIB2SgSYrZeKRdOAJ2lTz/+cci3ypBooOUmwjhSE7B4di7HZyv7JcnPWsHH5lH+eksfkYCknZX1IqXo9/58ra2XbS3rWN6JJppQgOnR7WnIeShevONVaUACfnQafwrobtGvRgKQhsFW14N8pZX70+KU/X9eL1fty/fG27v8AAASmfQ=='></script>
<script id='crowdsignal-rating-js-before'>
<!--//--><![CDATA[//><!--
PDRTJS_settings_8831506_post_1024={"id":8831506,"unique_id":"wp-post-1024","title":"Variational%20Inference%20algorithm","permalink":"https:\/\/langocthuyan.wordpress.com\/2020\/03\/24\/variational-inference-algorithm\/","item_id":"_post_1024"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_8831506_post_1024 == 'undefined' ){PDRTJS_8831506_post_1024 = new PDRTJS_RATING( PDRTJS_settings_8831506_post_1024 );}}
//--><!]]>
</script>
<script src='https://polldaddy.com/js/rating/rating.js?ver=wpcom' id='crowdsignal-rating-js'></script>
<script id='sharing-js-js-extra'>
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/mu-plugins/post-flair/sharing/sharing.js?m=1595340102h'></script>
<script type='text/javascript'>
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-twitter', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>		<iframe src='https://widgets.wp.com/likes/master.html?ver=20200826#ver=20200826' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script src="//stats.wp.com/w.js?61" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['identifyUser', 57803787, 'anvy1102']);
_tkq.push(['storeContext', {'blog_id':'60408846','blog_tz':'7','user_lang':'en','blog_lang':'en'}]);
_stq.push(['view', {'blog':'60408846','v':'wpcom','tz':'7','user':'1','user_id':'57803787','post':'1024','subd':'langocthuyan'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1zNDZ8S252Wis9XUQyb3YrcUVIU2R0VH5TcUpqcF9NWi1bMDJfLy90VXNvY2U3ZFZ1RWlDaW8lJnxjWWh+T0pXVHw3QXd3aHZjTTg4cU1zVnpCK2csXVtySFZOclExLVRLZ3lLYUR4OTBWYmIzYlZ1THg9Pzc1Q25FTWYyU0RadmFMejQsS3M9Vz1fVj9fNW1yQWUucS4sWzVMZ0hhUE1PSEEsRFp1eV0wUm1xanBXOUhRWkpoYjdjZy85LDN8SX4lWj1KOTc4RltxOGElaUdKTDRjQWlPR0svZisuWTdPfkZbVUxIdWhEZlo9cDk2LHIwQ0ZsPVdBJjZYZzMzWURNJVlfRUVOLnRCUWFQVVFXQ3Yta1F6JXZ5dDFsXUhrT29XeDdsfiswQ3kxXzNnTzh3TGRLRlp1bjk5N01jdG1aU3hLNT1bLSxKWy94W0FCQlBuWF13JV9dTFtEQ2F2JVt6RzdkL1tKYXRxeHViS05xY1FNSi5TZEZsbj16W2hnJSZ5Q2Y='}]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
		<div id="wpadminbar" class="nojq nojs ltr">
							<a class="screen-reader-shortcut" href="#wp-toolbar" tabindex="1">Skip to toolbar</a>
						<div class="quicklinks" id="wp-toolbar" role="navigation" aria-label="Toolbar" tabindex="0">
						<ul id="wp-admin-bar-root-default" class="ab-top-menu">
			
		<li id="wp-admin-bar-blog" class="my-sites mb-trackable"><a class="ab-item"  href="https://wordpress.com/sites/langocthuyan.wordpress.com">My Sites</a>		</li>
		<li id="wp-admin-bar-jumptotop-button-menu"><a class="ab-item"  href="#"><div id="jumptotop"><span class="noticon noticon-top"></span></div></a>		</li>
		<li id="wp-admin-bar-newdash" class="mb-trackable"><a class="ab-item"  href="https://wordpress.com/read">Reader</a>		</li>
		<li id="wp-admin-bar-amp"><a class="ab-item"  href="https://langocthuyan.wordpress.com/2020/03/24/variational-inference-algorithm/amp/"><span id="amp-admin-bar-item-status-icon">&#x1F517;</span> AMP</a>		</li>		</ul>
			<ul id="wp-admin-bar-top-secondary" class="ab-top-secondary ab-top-menu">
			
		<li id="wp-admin-bar-notes" class="menupop">		<div class="ab-item ab-empty-item" ><span id="wpnt-notes-unread-count" class="wpnt-loading wpn-read"></span><span class="noticon noticon-bell"></span><span class="ab-text">Notifications</span></div><div id="wpnt-notes-panel2" style="display:none" lang="en" dir="ltr"><div class="wpnt-notes-panel-header"><span class="wpnt-notes-header"></span><span class="wpnt-notes-panel-link"></span></div></div>		</li>
		<li id="wp-admin-bar-my-account" class="with-avatar mb-trackable"><a class="ab-item"  href="https://wordpress.com/me/"><img alt='' src='https://1.gravatar.com/avatar/d24262009cdf6377d9201d1c165f989d?s=32&#038;d=mm&#038;r=G' class='avatar avatar-32' height='32' width='32' /><span class="ab-text">Me</span></a>		</li>
		<li id="wp-admin-bar-ab-new-post" class="mb-trackable"><a class="ab-item"  href="https://wordpress.com/post/langocthuyan.wordpress.com"><span>Write</span></a>		</li>		</ul>
				</div>
							<a class="screen-reader-shortcut" href="https://langocthuyan.wordpress.com/wp-login.php?action=logout&#038;_wpnonce=188969057c">Log Out</a>
					</div>

	
<script type="text/javascript">
/* <![CDATA[ */
var clickDebugLink;

jQuery(document).ready( function($) {
	var single = true, w = 1000,
		supe = false;

	$(document.body).load(function(){ $('#wpadminbar img.grav-hashed').removeClass('grav-hashed'); }); // hack to hide the gravatar hovercard

	if ( single && supe )
		w = 1385;
	else if ( supe )
		w = 1200;

	// debug bar extra
	clickDebugLink = function( parent_id, obj ) {

		$('#'+parent_id).children('div').hide();

		document.getElementById( obj.href.substr( obj.href.indexOf( '#' ) + 1 ) ).style.display = 'block';
		$( obj.href.substr( obj.href.indexOf( '#' ) ) ).show()

		$(obj).parent().addClass('current').siblings('li').removeClass('current');

		return false;
	};

	$( '#wpadminbar #wp-admin-bar-shortlink' ).click( function() {
		$( '#adminbar-shortlink-input' ).select();
	});

	// skip tap-to-hover on site switcher for mobile
	if ( 'ontouchstart' in window ) {
		$('#wp-admin-bar-switch-site').on( 'touchstart', function( event ) {
			if ( $( window ).width() > 782 ) {
				return;
			}
			event.stopPropagation();
			$( event.target ).first( 'a' ).click();
		});
	}

});
/* ]]> */
</script>
	<div class="wpcom-bubble action-bubble">
		<div class="bubble-txt"></div>
	</div>
	<script type="text/javascript">function hideBubble() { jQuery('body').append( jQuery( 'div.wpcom-bubble' ).removeClass( 'fadein' ) ).off( 'click.bubble touchstart.bubble' ); jQuery(document).off( 'scroll.bubble' ); };</script>
		<script type="text/javascript">
	jQuery( '#wp-admin-bar-jumptotop-button-menu a' ).click( function( e ) {
		e.preventDefault();
		jQuery( 'html, body' ).animate( { scrollTop: 0 }, 'fast' );
	} );
	function hideShowTbJumpToTop() {
		var total_width = 0;
		// Calculate total width taken by items minus our button to see if it'll
		// overlap with other toolbar menus.
		jQuery( '#wp-admin-bar-root-default > li' ).each( function() {
			var self = jQuery( this );
			if ( 'wp-admin-bar-jumptotop-button-menu' != self.attr( 'id' ) )
				total_width += self.width();
		});
		if ( jQuery( '#wp-admin-bar-jumptotop-button-menu' ).position()['left'] - total_width < 10 ) {
			jQuery( '#jumptotop' ).animate( { 'top': '-50px' }, 'fast' );
		} else if (  jQuery( window ).scrollTop() >= 350 && parseInt( jQuery( '#jumptotop' ).css( 'top' ) ) < 0 ) {
			if ( jQuery( '#wp-admin-bar-jumptotop-button-menu' ).position()['left'] - total_width < 10 )
			   return;
			jQuery( '#jumptotop' ).animate( { 'top': 0 }, 'fast' );
		} else if (  jQuery( window ).scrollTop() < 1 && parseInt( jQuery( '#jumptotop' ).css( 'top' ) ) >= 0 ) {
			jQuery( '#jumptotop' ).animate( { 'top': '-50px' }, 'fast' );
		}
	}
	// handle on page load if auto scrolling to a position
	hideShowTbJumpToTop();
	// bind to scrolll event
	var jumpToTopTimer = null;
	jQuery( window ).scroll( function() {
		clearTimeout( jumpToTopTimer );
		jumpToTopTimer = setTimeout( jumpToTopRefresh, 150 );
	} );
	var jumpToTopRefresh = function() {
		hideShowTbJumpToTop();
	};
	</script>
	<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>
